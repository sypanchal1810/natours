{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/login.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["/* eslint-disable */\r\nexport const displayMap = locations => {\r\n  mapboxgl.accessToken =\r\n    'pk.eyJ1Ijoic2F1cmFiaDE4IiwiYSI6ImNsZWZ5aGlrazAxbWEzcm16MGlndXRraGQifQ.vazn88cywfBbpzBlQiTZlw';\r\n\r\n  const map = new mapboxgl.Map({\r\n    container: 'map',\r\n    style: 'mapbox://styles/saurabh18/cleg1s4j8001q01lkryj4n8tn',\r\n    scrollZoom: false,\r\n    // center: [-118.113491, 34.111745],\r\n    // zoom: 10,\r\n    interactive: false,\r\n  });\r\n\r\n  const bounds = new mapboxgl.LngLatBounds();\r\n\r\n  locations.forEach(loc => {\r\n    // Create marker\r\n    const el = document.createElement('div');\r\n    el.className = 'marker';\r\n\r\n    // Add marker\r\n    new mapboxgl.Marker({\r\n      element: el,\r\n      anchor: 'bottom',\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .addTo(map);\r\n\r\n    // Add popup\r\n    new mapboxgl.Popup({\r\n      offset: 30,\r\n      focusAfterOpen: false,\r\n    })\r\n      .setLngLat(loc.coordinates)\r\n      .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\r\n      .addTo(map);\r\n\r\n    // Extend map bounds to include current location\r\n    bounds.extend(loc.coordinates);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: {\r\n      top: 200,\r\n      bottom: 150,\r\n      left: 100,\r\n      right: 100,\r\n    },\r\n  });\r\n};\r\n","/* eslint-disable */\n\nexport const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","/* eslint-disable */\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: '/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully!');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: 'http://127.0.0.1:3000/api/v1/users/logout',\r\n    });\r\n    if ((res.data.status = 'success')) location.reload(true);\r\n  } catch (err) {\r\n    // console.log(err.response);\r\n    showAlert('error', 'Error logging out! Try again.');\r\n  }\r\n};\r\n","/* eslint-disable */\nimport axios from 'axios';\nimport { showAlert } from './alerts';\n\n// type is either 'password' or 'data'\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/users/updatePassword'\n        : '/api/v1/users/updateMe';\n\n    // console.log(url, data);\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data,\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully!`);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n","/* eslint-disable */\r\n\r\nimport axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const bookTour = async tourId => {\r\n  try {\r\n    const stripe = Stripe(\r\n      'pk_test_51MgYIJSC8ClaqFKfLEU14JQGj8r00IKTDg3K1n5y2mhT0daq0DwWBLf0abiePAbCWNJb5IUnLDoBsqChT48n0jtB00wfkGjKL9'\r\n    );\r\n\r\n    // 1) Get checkout session from API\r\n    const session = await axios(\r\n      `/api/v1/bookings/checkout-session/${tourId}`\r\n    );\r\n    // console.log(session);\r\n\r\n    // 2) Create checkout form + chanre credit card\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (err) {\r\n    console.log(err);\r\n    showAlert('error', err);\r\n  }\r\n};\r\n","/* eslint-disable */\r\nimport '@babel/polyfill';\r\nimport { displayMap } from './mapbox';\r\nimport { login, logout } from './login';\r\nimport { updateSettings } from './updateSettings';\r\nimport { bookTour } from './stripe';\r\n\r\n// DOM ELEMENTS\r\nconst mapBox = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\n// DELEGATION\r\nif (mapBox) {\r\n  const locations = JSON.parse(mapBox.dataset.locations);\r\n  displayMap(locations);\r\n}\r\n\r\nif (loginForm)\r\n  loginForm.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n\r\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\r\n\r\nif (userDataForm)\r\n  userDataForm.addEventListener('submit', e => {\r\n    e.preventDefault();\r\n\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n    updateSettings(form, 'data');\r\n  });\r\n\r\nif (userPasswordForm)\r\n  userPasswordForm.addEventListener('submit', async e => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n    const oldPassword = document.getElementById('password-current').value;\r\n    const newPassword = document.getElementById('password').value;\r\n    const newPasswordConfirm =\r\n      document.getElementById('password-confirm').value;\r\n    await updateSettings(\r\n      { oldPassword, newPassword, newPasswordConfirm },\r\n      'password'\r\n    );\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'Save password';\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', e => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourId } = e.target.dataset;\r\n    bookTour(tourId);\r\n  });\r\n}\r\n"],"names":["$3c4e158d14605c12$export$4c5dd147b21b9176","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","interactive","bounds","LngLatBounds","forEach","loc","el","document","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","Popup","offset","focusAfterOpen","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$7dc87b7f457e655a$export$516836c6a9dfc573","querySelector","parentElement","removeChild","$7dc87b7f457e655a$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$bf5b431e6a69fea8$export$596d806903d1f59e","async","email","password","$parcel$interopDefault","$cnf0l$axios","method","url","data","status","location","assign","err","response","message","$955535ce7513e32c$export$f558026a994b6051","toUpperCase","$9fd71c92b6f885af$export$8d5bdbf26681c0c2","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","console","log","$407eccdc61ba7a94$var$mapBox","getElementById","$407eccdc61ba7a94$var$loginForm","$407eccdc61ba7a94$var$logOutBtn","$407eccdc61ba7a94$var$userDataForm","$407eccdc61ba7a94$var$userPasswordForm","$407eccdc61ba7a94$var$bookBtn","JSON","parse","dataset","addEventListener","e","preventDefault","value","reload","form","FormData","append","files","textContent","oldPassword","newPassword","newPasswordConfirm","target"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}